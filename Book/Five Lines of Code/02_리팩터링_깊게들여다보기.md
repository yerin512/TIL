
# 2장 리팩터링 깊게 들여다보기

이번 장에서 다룰 내용
- 가독성을 통한 의도 전달
- 유지보수성 개선을 위한 불변속성(invariant) 지역화
- 개발 속도 향상을 위한, 추가(addition)을 통해 변경 가능하게 만들기
- 리팩터링의 일상 업무화

리팩터링이 무엇이며 그것이 왜 기술적 관점에서 중요한지에 대한 튼튼한 기반을 만들기 위한 기술적 세부사항 -> ?


## 2.1 가독성 및 유지보수성 향상
더 나은 코드를 만드는 것, 코드가 하는 일을 변경하지 않는다는 중요한 내용을 살펴보자.

### 2.1.1. 코드 개선

##### 가독성
가독성은 의도를 전달하기 위한 코드의 성질이다. 코드가 의도한 대로 작동한다는 가정이 있으면 코드가 무슨 일을 하는지 파악하기가 매우 쉽다. 코드에서 의도를 전달하는 방법은 여러가지다. 코딩 컨벤션을 지정하고 따르는 것, 주석 달기, 변수, 메서드, 클래스 및 파일 이름 지정, 공백 사용 등.

##### 유지보수성

유지보수성이란 얼마나 많은 후보를 조사해야 하는지를 나타내는 표현.
현재 코드가 무슨 일을 하는지 파악하고, 새로운 목표를 수용하기 위해 코드를 안전하고 빠르며 쉽게 수정할 수 있는 방법은 무엇인지 찾으려고 시도함.
그 시도를 얼마나 하냐는 뜻인 거 같다.

유지보수성은 변경 시 발생하는 위험과 밀접하게 관련이 되어있다.
조사 단계에서 시간이 오래 걸린다는 것은 코드 유지보수성이 나쁘다는 징후다.

취약성의 근원은 일반적으로 전역상태(global state)이다.
여기서 전역(global)은 우리가 고려한 범위(scope)를 벗어난 것을 의미한다. 메서드로 생각하면 내부 변수가 전역 변수를 참조하는 것이다.
상태의 개념은 추상적이다. 프로그램이 실행되는 동안 변경될 수 있는 모든 것을 말한다.
변수뿐만 아니라, 데이터베이스의 데이터, 하드디스크의 파일, 하드웨어 자체도 포함된다.



### 2.1.2. 코드가 하는 일을 바꾸지 않고 유지보수하기

리팩터링의 세 가지 핵심
1. 의도를 전달함으로써 가독성 향상
2. 불변속성의 범위제한을 통한 유지보수성 향상
3. 범위 밖의 코드에 영향을 주지 않고 1항과 2항을 수행

기본적으로 리팩터링 코드를 예약해서 다른 사람이 변경하지 않게 해야한다.

## 2.2 속도, 유연성 및 안정성 확보

높은 유지보수성은 몇 가지 혜택을 준다.
변수명이 가독성을 높이거나 줄일 수 있지만 코드의 품질에 가장 큰 영향을 미치는 것은 아키텍처 변경임.

### 2.2.1 상속보다는 컴포지션 사용

대부분의 리팩터링 패턴과 규칙은 구체적으로 객체 컴포지션을 돕기 위한 것을임.
즉, 객체가 내부에 다른 객체의 참조를 가지는 것.

- 유연성

컴포지션을 중심으로 만들어진 시스템을 사용하면 다른 방식보다 더 깔끔하게 코드를 결합하고 재사용할 수 있다. 모든 것이 서로 맞게 조립 되어있으면 유연해진다.

### 2.2.2 수정이 아니라 추가로 코드를 변경

컴포지션의 큰 장점은 추가로 변경이 가능하다는 것.


## 2.3 리팩터링과 일상 업무

- 레거시 시스템에서는 변경하기 전에 먼저 리팩터링하십시오. 그런 다음 작업 절차를 따르십시오
- 코드를 변경한 후에도 리팩터링하십시오.

"항상 여러분이 왔을 때보다 더 좋게 만들어 놓고 떠나세요."


## 2.4 소프트웨어 분야에서 '도메인' 정의하기

소프트웨어는 그것이 작업 절차를 자동화하는 것이든, 실제 사건을 추적 또는 시뮬레이션하는 것이든, 관계없이 실생활의 특정 측면을 모델링한 것이다.

이 실제 세계의 구성요소를 소프트웨어의 도메인이라고 한다.



## 요약

- 리팩터링은 기능 변경 없이 코드의 의도를 전달하고 불변속성의 범위를 제한하는 것
- 상속보다 컴포지션을 사용함으로써, 추가를 통한 변경으로 개발 속도, 유연성, 안정성을 확보함
- 리팩터링을 일상 업무에 포함시켜 기술 부채가 쌓이지 않도록 해야함
- 리팩터링을 연습하면 코드에 대한 독특한 관점을 얻을 수 있으며, 이로 인해 더 나은 해결책을 찾을 수 있음































